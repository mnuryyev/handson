---
// src/components/LangSwitcher.astro
const { pathname } = Astro.url;
const base = import.meta.env.BASE_URL; // Это наш "/handson/"

// Проверяем, есть ли сейчас в пути /en/
// Важно: ищем именно внутри пути, так как в начале теперь /handson/
const isEn = pathname.includes('/en/');
const currentLang = isEn ? 'en' : 'ru';

let targetPath;

if (isEn) {
    // Если мы на английском, меняем /en/ на /ru/
    targetPath = pathname.replace('/en/', '/ru/');
} else if (pathname.includes('/ru/')) {
    // Если на русском, меняем /ru/ на /en/
    targetPath = pathname.replace('/ru/', '/en/');
} else {
    // Если мы на главной (например, /handson/ru/ или просто /handson/)
    targetPath = `${base}en/`;
}
---

<div class="lang-switch">
  {/* Ссылка на RU версию */}
  <a 
    href={isEn ? targetPath : pathname} 
    class={currentLang === 'ru' ? 'active' : ''}
  >
    RU
  </a>
  
  <span class="sep">/</span>
  
  {/* Ссылка на EN версию */}
  <a 
    href={isEn ? pathname : targetPath} 
    class={currentLang === 'en' ? 'active' : ''}
  >
    EN
  </a>
</div>

<style>
  .lang-switch {
    display: flex;
    align-items: center;
    gap: 5px;
    font-weight: 500;
    font-size: 0.85rem;
  }
  .lang-switch a {
    text-decoration: none;
    color: #555;
    transition: 0.2s;
  }
  .lang-switch a.active {
    color: #fff;
    pointer-events: none; /* Чтобы нельзя было кликнуть на текущий язык */
  }
  .lang-switch a:hover:not(.active) {
    color: var(--accent);
  }
  .sep {
    color: #333;
  }
</style>
