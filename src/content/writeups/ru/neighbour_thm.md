---
title: "Neighbour - TryHackMe (Easy)"
description: "Разбор веб-машины Neighbour на TryHackMe: эксплуатация уязвимости IDOR, обход контроля доступа и получение данных другого пользователя"
image: "/images/neighbour_thm/thm_main.png"
date: "17 февраля 2026"
---

**Insecure Direct Object Reference (IDOR)** - это классическая уязвимость категории **Broken Access Control (A01 в OWASP Top 10 2021)**, при которой приложение позволяет пользователю напрямую обращаться к внутренним объектам системы (профили, файлы, записи в базе данных) путём изменения параметров запроса, при этом сервер не выполняет проверку прав доступа.

Фактически приложение доверяет данным, полученным от клиента, и не контролирует, имеет ли пользователь право запрашивать конкретный объект. В результате злоумышленник может изменить идентификатор в запросе и получить доступ к чужим данным.

В рамках данной работы мы рассмотрим уязвимость **IDOR** на примере простой веб-машины **Neighbour** с платформы TryHackMe. Развернём лабораторную среду и последовательно пройдём путь от этапа разведки до получения флага администратора.

## Фаза 1. Разведка и доступ к приложению

![01_intro](/handson/neighbour_thm/01_intro.png)

![02_intro](/handson/neighbour_thm/02_intro.png)

Машина **Neighbour** это веб-приложение под названием "Authentication Anywhere", которое якобы позволяет безопасно логиниться откуда угодно.

Приложение используется для проверки контроля доступа. Необходимо определить, можно ли получить доступ к чужим профилям и данным через изменение параметров запросов, что соответствует уязвимости типа **IDOR**.

### Шаг 1. Доступ к веб-приложению

После запуска виртуальной машины получаем целевой IP‑адрес, ***10.10.138.87***.

![03_login_page](/handson/neighbour_thm/03_login_page.png)

Открываем браузер и переходим по адресу: **http://10.10.138.87**

Нас встречает страница логина с двумя полями: Username и Password. Под формой мелким шрифтом подсказка:
Don't have an account? Use the guest account! (Ctrl+U)

### Шаг 2. Анализ исходного кода страницы

![08_code](/handson/neighbour_thm/08_code.png)

Нажимаем Ctrl+U, чтобы открыть исходный HTML‑код. В конце документа есть закомментированный фрагмент: guest:guest.

В комментарии указаны учётные данные тестового пользователя. Используем их для входа в систему: в поле Username вводим guest, в поле Password guest, после чего нажимаем кнопку Login и выполняем авторизацию.

![04_guest](screens/04_guest.png)

### Шаг 3. Первое знакомство с профилем

После успешного входа нас перенаправляет на страницу: http://10.10.138.87/profile.php?user=guest

![05_guest_page](/handson/neighbour_thm/05_guest_page.png)

Сразу обращаем внимание на адресную строку браузера. В URL видно параметр: **?user=guest** Это значит, что приложение подставляет имя пользователя прямо в запрос и по этому значению загружает профиль. То есть страница формируется на основе параметра user, который мы можем изменить вручную.

Если сервер дополнительно не проверяет, имеет ли текущий пользователь право просматривать запрашиваемый профиль, то достаточно просто поменять значение параметра в URL, чтобы попытаться получить доступ к данным другого пользователя.

* * *

## Фаза 2. Эксплуатация уязвимости IDOR

### Шаг 4. Простая манипуляция параметром

Меняем значение параметра user прямо в адресной строке браузера: с guest на admin. **?user=admin**

![06_admin](/handson/neighbour_thm/06_admin.png)

Приложение отображает данные для администратора.

Видим, что сервер не проверяет права доступа и просто использует значение параметра для выбора профиля.

![07_flag](/handson/neighbour_thm/07_flag.png)

### Шаг 5. Подтверждение и анализ

Мы авторизовались как обычный пользователь guest, однако смогли получить доступ к профилю администратора просто изменив значение параметра в URL. Приложение без каких‑либо проверок отобразило чужие данные.

Сервер полностью доверяет значению параметра user и не проверяет:

- совпадает ли запрашиваемый профиль с текущей пользовательской сессией;
- обладает ли пользователь необходимыми правами (например, ролью администратора);
- разрешён ли доступ к запрашиваемому объекту в принципе.

Фактически приложение использует идентификатор из запроса напрямую, без контроля доступа. Это и является классическим примером уязвимости **Insecure Direct Object Reference (IDOR)**.

* * *

Фаза 3. Реальные проблемы и мастабы

Хотя Neighbour выглядит как учебная задача, подобные ошибки регулярно встречаются и в реальных production‑приложениях. Проблема возникает тогда, когда сервер принимает идентификатор объекта из запроса и не проверяет, имеет ли текущий пользователь право на доступ к этим данным. 

Чаще всего уязвимость проявляется при использовании:

- последовательных числовых идентификаторов;
- предсказуемых UUID;
- строковых идентификаторов (username, email);
- параметров в API‑запросах.

Если сервер не связывает запрашиваемый объект с текущей сессией пользователя и не выполняет проверку прав доступа, возникает классический IDOR.

* * *

Фаза 4. Как правильно защищаться от IDOR

Чтобы закрыть такую уязвимость, нужно делать проверки на стороне сервера. Нельзя доверять параметрам из URL или данным, которые приходят от клиента.

Прямая проверка владения объектом, при каждом запросе сервер должен проверять, принадлежит ли запрашиваемый объект текущему пользователю и есть ли у него права на доступ. Если объект ему не принадлежит, то доступ должен быть запрещён.
